<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯Œé‚¦ä¿Šå¾· | å®¶æ—è³‡ç”¢å®ˆè­·è€… - 60ç§’é¢¨éšªæª¢æ¸¬</title>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f1f5f9; font-size: 18px; }
        .gradient-main { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); }
        .option-btn { transition: all 0.2s ease; border: 3px solid #f1f5f9; line-height: 1.5; cursor: pointer; }
        .option-btn:hover { border-color: #ef4444; background-color: #fef2f2; transform: translateY(-2px); }
        .glass-card { background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(10px); }
    </style>
</head>
<body class="text-slate-900">

    <div id="loading" class="min-h-screen flex items-center justify-center bg-slate-900 text-white">
        <div class="text-center">
            <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-white mx-auto mb-4"></div>
            <p class="text-xl">é€£ç·š LINE ç³»çµ±ä¸­...</p>
        </div>
    </div>

    <div id="hero" class="hidden min-h-screen flex flex-col items-center justify-center p-6 text-center gradient-main text-white">
        <div class="mb-4"><p class="text-2xl font-bold text-slate-300">å¯Œé‚¦ä¿Šå¾·</p><p class="text-lg text-slate-400">æ‚¨çš„å®¶æ—è³‡ç”¢å®ˆè­·è€…</p></div>
        <div class="mb-6 inline-block px-6 py-2 bg-red-500/20 rounded-full border border-red-500/50"><span class="text-red-400 font-bold text-lg tracking-widest uppercase">â±ï¸ å¿«é€Ÿé¢¨éšªè©•ä¼°</span></div>
        <h1 class="text-4xl md:text-6xl font-black mb-8 leading-tight">æ‚¨å¥½ï¼Œ<span id="user-greeting" class="text-red-500">è²´è³“</span><br>åªéœ€ <span class="text-yellow-400">60 ç§’</span><br>æŒæ¡æ‚¨çš„å®¶æ—è²¡å¯Œå®‰å…¨</h1>
        <p class="text-xl md:text-2xl text-slate-400 mb-12 max-w-2xl leading-relaxed">è¾›è‹¦ä¸€è¼©å­çš„è³‡ç”¢ï¼Œæœ€å¾Œæ˜¯ã€Œç•™æ„›ã€é‚„æ˜¯ã€Œç•™å‚µã€ï¼Ÿ<br><span class="text-white border-b-2 border-red-500">ç«‹å³é€²è¡Œ 10 é¡Œæ ¸å¿ƒæª¢æ¸¬ï¼Œäº†è§£æ‚¨çš„å‚³æ‰¿åœ°é›·ã€‚</span></p>
        <button onclick="startQuiz()" class="bg-red-600 hover:bg-red-700 text-white px-16 py-6 rounded-xl text-3xl font-black shadow-2xl transition-all transform hover:scale-105">é–‹å§‹æª¢æ¸¬</button>
    </div>

    <div id="quiz-container" class="hidden min-h-screen py-12 px-4 max-w-4xl mx-auto">
        <div class="mb-10 text-center">
            <span id="step-indicator" class="text-red-600 font-black text-2xl font-mono">01 / 10</span>
            <div class="w-full bg-slate-200 rounded-full h-4 mt-4 overflow-hidden"><div id="progress-bar" class="bg-red-600 h-full transition-all duration-500" style="width: 10%"></div></div>
        </div>
        <div id="question-card" class="glass-card p-10 md:p-16 rounded-3xl shadow-2xl border border-white animate__animated">
            <div id="category-tag" class="text-lg font-bold text-red-500 mb-4 tracking-widest uppercase border-b-2 border-red-100 inline-block">æ³•å¾‹é¢¨éšª</div>
            <h2 id="question-text" class="text-3xl md:text-4xl font-bold mb-10 text-slate-900 leading-snug">è¼‰å…¥ä¸­...</h2>
            <div id="options-grid" class="grid grid-cols-1 gap-6"></div>
            <p id="sub-hint" class="mt-8 text-xl text-blue-600 bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500 hidden"></p>
        </div>
    </div>

    <div id="result-page" class="hidden py-12 px-4 max-w-6xl mx-auto">
        <div class="text-center mb-12">
            <h2 class="text-4xl font-black text-slate-900 mb-4"><span id="display-name" class="text-red-600"></span> æ‚¨çš„è¨ºæ–·å ±å‘Š</h2>
            <div class="h-1.5 w-32 bg-red-600 mx-auto"></div>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-10">
            <div class="lg:col-span-5 bg-white p-10 rounded-3xl shadow-xl text-center border-t-[12px]" id="status-border">
                <p class="text-slate-500 font-bold tracking-widest text-xl mb-4">é¢¨éšªç¸½å¾—åˆ†</p>
                <div class="text-9xl font-black my-6 text-slate-900" id="score-display">0</div>
                <div id="risk-badge" class="inline-block px-8 py-3 rounded-xl text-white font-bold text-2xl mb-8 shadow-lg">åˆ†æä¸­...</div>
                <p id="risk-desc" class="text-left text-slate-700 leading-relaxed text-xl font-medium bg-slate-50 p-6 rounded-2xl"></p>
            </div>
            <div class="lg:col-span-7 bg-white p-10 rounded-3xl shadow-xl"><h3 class="font-bold text-2xl mb-8">ğŸ“Š å››å¤§ç¶­åº¦é¢¨éšªåˆ†æ</h3><canvas id="riskChart"></canvas></div>
        </div>
        <div class="mt-16 text-center border-t-2 border-slate-100 pt-12">
            <p class="text-slate-700 text-3xl font-black mb-4">å¯Œé‚¦ä¿Šå¾·</p>
            <p class="text-slate-500 text-xl mb-8 font-bold italic">æ‚¨çš„å®¶æ—è³‡ç”¢å®ˆè­·è€…</p>
            <a href="https://line.me/R/ti/p/@hd022311" onclick="trackClick()" target="_blank" class="inline-block bg-red-600 text-white px-16 py-5 rounded-2xl font-black text-2xl shadow-2xl hover:bg-red-700 transition-all">é ç´„ 1å°1 å°ˆæ¥­è«®è©¢</a>
        </div>
    </div>

    <script>
        let userName = "è²´è³“", currentStep = 0, totalScore = 0, userAnswers = [], lastLevel = "";
        let catScores = { "æ³•å¾‹é¢¨éšª": 0, "è³‡ç”¢é…ç½®": 0, "ç¨…å‹™è² æ“”": 0, "å®¶åº­å’Œè«§": 0 };
        const liffId = "2008902145-CBzFiJo3";

        async function initLiff() {
            try {
                await liff.init({ liffId: liffId });
                if (!liff.isLoggedIn()) { liff.login(); } 
                else {
                    const profile = await liff.getProfile();
                    userName = profile.displayName;
                    document.getElementById('user-greeting').innerText = userName;
                    document.getElementById('loading').classList.add('hidden');
                    document.getElementById('hero').classList.remove('hidden');
                }
            } catch (e) { document.getElementById('loading').classList.add('hidden'); document.getElementById('hero').classList.remove('hidden'); }
        }
        window.onload = initLiff;

        const questions = [
            { category: "æ³•å¾‹é¢¨éšª", q: "æ‚¨çš„å¹´é½¡ç¯„åœï¼Ÿ", options: ["40æ­²ä»¥ä¸‹", "40-50æ­²", "50-60æ­²", "60-70æ­²", "70æ­²ä»¥ä¸Š"], scores: [1,2,3,4,5] },
            { category: "è³‡ç”¢é…ç½®", q: "è³‡ç”¢é…ç½®é›†ä¸­åº¦ï¼Ÿ", options: ["å¤šå…ƒå‡è¡¡", "2-3ç¨®è³‡ç”¢é¡å‹", "ä¸»è¦é›†ä¸­2ç¨®", "å–®ä¸€è³‡ç”¢(å¦‚90%æˆ¿ç”¢)", "å–®ä¸€è³‡ç”¢ä¸”è®Šç¾å›°é›£"], scores: [1,2,3,4,5] },
            { category: "ç¨…å‹™è² æ“”", q: "é ä¼°ã€Œéºç”¢æ·¨é¡ã€ç´šè·ï¼Ÿ", hint: "ğŸ’¡ æç¤ºï¼šæ·¨é¡ = ç¸½è³‡ç”¢ - å…ç¨…é¡ 1,333è¬ - æ‰£é™¤é¡", options: ["å…ç¨…", "5,621 è¬ä»¥ä¸‹", "5,621 è¬-1.12 å„„", "1.12 å„„ä»¥ä¸Š", "è¦æ¨¡æ¥µå¤§ä¸”çµæ§‹è¤‡é›œ"], scores: [1,2,3,4,5] },
            { category: "å®¶åº­å’Œè«§", q: "ç¹¼æ‰¿äºº(é…å¶/å­å¥³)é—œä¿‚ï¼Ÿ", options: ["å’Œè«§ä¸€è‡´", "è‰¯å¥½ä½†æœªæºé€š", "å¶æœ‰åˆ†æ­§", "é—œä¿‚ç·Šå¼µ", "å·²æœ‰æ˜é¡¯ç³¾ç´›"], scores: [1,2,3,4,5] },
            { category: "æ³•å¾‹é¢¨éšª", q: "ç›®å‰è¦åŠƒå®Œæ•´åº¦ï¼Ÿ", options: ["å·²å®Œæˆè¦åŠƒ", "æœ‰åŸºæœ¬ä½†ä¸è¶³", "åƒ…æœ‰å£é ­ç´„å®š", "æœ‰æƒ³æ³•æœªåŸ·è¡Œ", "å®Œå…¨æ²’æœ‰è¦åŠƒ"], scores: [1,2,3,4,5] },
            { category: "ç¨…å‹™è² æ“”", q: "ç¹³ç¨…æµå‹•ç¾é‡‘æº–å‚™ï¼Ÿ", options: ["éå¸¸å……è¶³", "å¯æ”¯ä»˜å¤§åŠ", "åƒ…èƒ½æ‡‰ä»˜éƒ¨åˆ†", "éœ€è³£æˆ¿ç±ŒéŒ¢", "å®Œå…¨ç„¡æµå‹•è³‡"], scores: [1,2,3,4,5] },
            { category: "è³‡ç”¢é…ç½®", q: "ä¸å‹•ç”¢æŒæœ‰ç‹€æ³ï¼Ÿ", options: ["ç„¡æˆ–å·²åˆ†é…", "1-2ç­†ä¸”ç”¢æ¬Šå–®ç´”", "3-5ç­†éƒ¨åˆ†å…±æœ‰", "å¤šç­†ä¸”å¤šç‚ºå…±æœ‰", "ç”¢æ¬Šè¤‡é›œç³¾ç´›"], scores: [1,2,3,4,5] },
            { category: "å®¶åº­å’Œè«§", q: "ä¼æ¥­æˆ–å¤§é¡è³‡ç”¢æ¥ç­å®‰æ’ï¼Ÿ", options: ["ä¸é©ç”¨æˆ–å·²è¦åŠƒ", "åŸ¹é¤Šæ¥ç­äººä¸­", "æœªæ­£å¼è‚¡æ¬Šäº¤æ¥", "æ¥ç­æ„é¡˜ä¸æ˜", "ç„¡æ¥ç­äººæ„é¡˜"], scores: [1,2,3,4,5] },
            { category: "è³‡ç”¢é…ç½®", q: "ä¿éšªå—ç›ŠäººæŒ‡å®šï¼Ÿ", options: ["è¶³é¡ä¸”å—ç›Šäººæ˜ç¢º", "ä¿é¡å¯èƒ½ä¸è¶³", "åŸºæœ¬ä¿é¡åä½", "å—ç›ŠäººæœªæŒ‡å®š", "å®Œå…¨æ²’æœ‰ä¿éšª"], scores: [1,2,3,4,5] },
            { category: "ç¨…å‹™è² æ“”", q: "éš±æ€§è² å‚µèˆ‡ä¿è­‰è²¬ä»»ï¼Ÿ", options: ["ç„¡ä»»ä½•è² å‚µ", "å°‘é‡è² å‚µ", "ä¸­ç­‰é‚„æ¬¾ä¸­", "è² å‚µæ¯”é«˜", "é«˜é¡è² å‚µ/ä¿è­‰"], scores: [1,2,3,4,5] }
        ];

        function startQuiz() { document.getElementById('hero').classList.add('hidden'); document.getElementById('quiz-container').classList.remove('hidden'); showQuestion(); }

        function showQuestion() {
            const q = questions[currentStep];
            document.getElementById('step-indicator').innerText = `${String(currentStep + 1).padStart(2, '0')} / 10`;
            document.getElementById('category-tag').innerText = q.category;
            document.getElementById('question-text').innerText = q.q;
            document.getElementById('progress-bar').style.width = `${((currentStep + 1) / questions.length) * 100}%`;
            const hintEl = document.getElementById('sub-hint');
            if(q.hint) { hintEl.innerText = q.hint; hintEl.classList.remove('hidden'); } else { hintEl.classList.add('hidden'); }
            const grid = document.getElementById('options-grid');
            grid.innerHTML = '';
            q.options.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.className = "option-btn text-left p-6 rounded-2xl bg-white text-slate-800 font-bold text-2xl shadow-sm border-2 border-slate-100";
                btn.innerText = opt;
                btn.onclick = () => {
                    userAnswers.push(opt);
                    catScores[q.category] += q.scores[idx];
                    totalScore += q.scores[idx];
                    currentStep++;
                    if(currentStep < questions.length) showQuestion(); else finishQuiz();
                };
                grid.appendChild(btn);
            });
        }

        function finishQuiz() {
            document.getElementById('quiz-container').classList.add('hidden'); document.getElementById('result-page').classList.remove('hidden');
            document.getElementById('display-name').innerText = userName; document.getElementById('score-display').innerText = totalScore;
            let level = ""; const badge = document.getElementById('risk-badge'), desc = document.getElementById('risk-desc'), border = document.getElementById('status-border');
            if(totalScore <= 20) { level="ä½é¢¨éšª"; badge.className="inline-block px-8 py-3 rounded-xl text-white font-bold text-2xl mb-8 shadow-lg bg-emerald-500"; border.style.borderColor="#10b981"; desc.innerText="è³‡ç”¢å‚³æ‰¿æ¶æ§‹ç©©å¥ï¼Œé¢¨éšªè¼ƒä½ã€‚å»ºè­°å®šæœŸè¤‡æª¢æ³•è¦è®Šå‹•ã€‚"; }
            else if(totalScore <= 30) { level="ä¸­ä½é¢¨éšª"; badge.className="inline-block px-8 py-3 rounded-xl text-white font-bold text-2xl mb-8 shadow-lg bg-blue-500"; border.style.borderColor="#3b82f6"; desc.innerText="å·²æœ‰åŸºæœ¬è¦åŠƒï¼Œä½†éƒ¨åˆ†ç´°ç¯€ä»æœ‰æ³•å¾‹æˆ–ç¨…å‹™éš±æ†‚ã€‚"; }
            else if(totalScore <= 40) { level="ä¸­é«˜é¢¨éšª"; badge.className="inline-block px-8 py-3 rounded-xl text-white font-bold text-2xl mb-8 shadow-lg bg-orange-500"; border.style.borderColor="#f97316"; desc.innerText="è­¦å‘Šï¼è³‡ç”¢æ¶æ§‹å­˜åœ¨æ¼æ´ï¼Œå®¹æ˜“å¼•ç™¼éºç”¢ç¨…çˆ­è­°æˆ–åˆ†é…ç³¾ç´›ã€‚"; }
            else { level="é«˜åº¦å±æ©Ÿ"; badge.className="inline-block px-8 py-3 rounded-xl text-white font-bold text-2xl mb-8 shadow-lg bg-red-600"; border.style.borderColor="#dc2626"; desc.innerText="é«˜åº¦å±æ©Ÿï¼æ¥µåº¦ç¼ºä¹æ³•å¾‹é˜²ç¦¦ï¼Œå¯èƒ½é¢è‡¨åš´é‡çš„ç¹¼æ‰¿çˆ­è­°ã€‚"; }
            badge.innerText = level; lastLevel = level;
            initChart(); 
            sendToForm(userName, totalScore, level, userAnswers, "å°šæœªé»æ“Š");
        }

        function initChart() {
            const ctx = document.getElementById('riskChart').getContext('2d');
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['ç¨…å‹™è² æ“”', 'æ³•å¾‹é¢¨éšª', 'è³‡ç”¢é…ç½®', 'å®¶åº­å’Œè«§'],
                    datasets: [{
                        data: [catScores['ç¨…å‹™è² æ“”'], catScores['æ³•å¾‹é¢¨éšª'], catScores['è³‡ç”¢é…ç½®'], catScores['å®¶åº­å’Œè«§']],
                        backgroundColor: 'rgba(220, 38, 38, 0.15)', borderColor: 'rgb(220, 38, 38)', pointRadius: 6
                    }]
                },
                options: { scales: { r: { min: 0, max: 15, pointLabels: { font: { size: 18, weight: 'bold' } } } }, plugins: { legend: { display: false } } }
            });
        }

        function trackClick() {
            sendToForm(userName, totalScore, lastLevel, userAnswers, "æ˜¯ï¼å·²é»æ“Šé ç´„");
        }

        function sendToForm(name, score, level, ans, clicked) {
            const formID = "1FAIpQLSe8EsQpwdNm7qgKG3hceNoFFQkqeH4GsfrFfa2LSHWH9bgh9g";
            const formData = new URLSearchParams();
            formData.append("entry.971217626", name);
            formData.append("entry.633037987", ans[0]); formData.append("entry.1831916720", ans[1]); formData.append("entry.1839695038", ans[2]);
            formData.append("entry.1304028661", ans[3]); formData.append("entry.1174048833", ans[4]); formData.append("entry.1468704162", ans[5]);
            formData.append("entry.1568346374", ans[6]); formData.append("entry.1971063395", ans[7]); formData.append("entry.1375223568", ans[8]);
            formData.append("entry.1919892895", ans[9]); formData.append("entry.2100896180", score); formData.append("entry.747483575", level);
            formData.append("entry.204713512", clicked);
            const formUrl = `https://docs.google.com/forms/d/e/${formID}/formResponse?${formData.toString()}&submit=Submit`;
            fetch(formUrl, { method: "POST", mode: "no-cors" });
        }
    </script>
</body>
</html>
